![](https://velog.velcdn.com/images/daehyeong2/post/c284ffb7-e7a4-4be7-a2b4-4bad99a153a3/image.jpeg)
## 개요
이번에 객체 탐지 모델을 설계하면서, 3가지 축에서 바라본 2d 평면 데이터(xy, xz, yz)를 활용하게 되었다.
그래서 기존 2D 평면 기반 객체 탐지 모델에서 어떻게 바뀌는지 간단히 정리해보았다.

## 다차원 이미지 학습 전략
### 1. Early Fusion
Early Fusion은 다른 방법에 비해 간단하게 구현할 수 있다.
만약 3차원의 데이터를 Faster-RCNN 모델에게 학습시킨다고 가정해보자.
우리는 단순하게 Faster-RCNN의 conv1 layer의 입력 채널을 3으로 조정하여 각 채널에 각 차원의 이미지를 넣어주면 된다.

> channel 1 <- dimension 1 (xy axis)
channel 2 <- dimension 2 (xz axis)
channel 3 <- dimension 3 (yz axis)

기존 C,H,W 구조에서 N,H,W (N-dimension) 구조로 바꾸어 사용한 것이다. 이때 RGB를 표현하던 채널이 사라지고 다른 차원에 대한 정보를 표현하는 것으로 대체되었기에 각 이미지들은 흑백으로 변환되어 모델에 입력될 것이다.

이렇게 하면 모델의 큰 구조는 건드리지 않고 입력 채널만을 조정하여 각 차원의 정보를 반영할 수 있다.

#### 장점
- 간단하게 다차원 이미지를 학습시킬 수 있음
- 기존 2D 객체 탐지 모델 활용 가능
#### 단점
- 학습 중간에는 각 차원의 이미지가 한 개의 feature map으로 합쳐지기에 개별적인 분석이 힘들다 (ex. Grad-Cam)
- 입력 채널만을 바꾸었기에 다른 방법에 비해 성능적인 향상이 크지 않을 수도 있다.
- RGB 채널을 대체하는 방식이기에 컬러가 중요한 데이터셋인 경우 적합하지 않을 수 있다.

### 2. Mid Fusion
각 평면 데이터들을 별도의 backbone 혹은 같은 backbone에서 처리한 후, feature map 수준에서 합성 (concat)하여 학습.
이는 초반에 다른 평면 간의 간섭이 없어 독립적으로 특성 추출 가능함.


#### 장점
- 평면별 독립적으로 특성 추출 가능
- 각 feature map을 결합하는 방법이 다양함
- 성능대비 유연성과 안정성이 높음 -> 연구에서 자주 좋은 결과가 나옴
#### 단점
- backbone을 한번 이상 수행해야 해서 연산량이 증가함
- 모델 구조가 조금 복잡해짐
- 차원 수가 늘어날 수록 관리가 어려움

### 3. Late Fusion
각 평면별로 독립적으로 예측을 수행하고 마지막 bbox / score / class 단계에서 결과를 결합하는 방식.

> ex. NMS 합성, Confidence Reweighting, Voting 등

#### 장점
- 기존 모델을 그대로 사용하고 결과만 합치기에 구조가 매우 단순함
- 각 평면의 모델을 독립적으로 최적화 가능
- 차원 수가 늘어나더라도 모델을 하나 더 만들고 결과만 합치면 되서 확장이 쉬움
#### 단점
- 모델 간 상호 보완 학습이 불가능함. (서로 예측에 영향을 주지 않기 때문)
- 정교한 융합이 어려움
- 추론 시 비용이 큼 (차원 수만큼 모델을 실행해야 함)


## 요약
| Fusion 방식        | 결합 시점               | 장점                        | 단점                    | 추천 상황                        |
| ---------------- | ------------------- | ------------------------- | --------------------- | ---------------------------- |
| **Early Fusion** | 입력 단계               | 간단하고 일관된 파이프라인            | 모달 특성 상실 위험, 정렬 문제 민감 | 동일 형태 데이터(예: 3 평면 grayscale) |
| **Mid Fusion**   | Backbone 중간 feature | 가장 밸런스 좋고 성능 좋게 나오는 경우 많음 | 구조 복잡, 연산량 증가         | 다른 모달 조합 / 연구 실험 중심            |
| **Late Fusion**  | Output 단계           | 적용 쉬움, 기존 모델 재사용 가능       | 상호보완 학습 불가능           | 모델 앙상블, 빠른 성능 향상 목적          |


## 마치며
이번 글에서 다차원 이미지를 객체 탐지에 활용하는 법을 정리해보았다.
필자의 경우 xy, xz, yz의 2d 평면 데이터를 가지고 있고, 각 평면 데이터를 결합해 다차원으로 학습시킬 것이다.
모두 흑백이기에 RGB 채널이 손실되어도 괜찮고, 어떤 평면 데이터 조합이 성능이 좋은지 판단하기 위해서 빠르게 진행해볼 수 있는 Early Fusion을 진행하였다.

아마도 Early Fusion을 통해 최적 평면 조합을 알게 되면, Mid Fusion을 활용해 feature map 수준에서의 결합을 진행할 것 같다.
